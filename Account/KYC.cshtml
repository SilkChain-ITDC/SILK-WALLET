@model SKC.Entity.DBModels.SkcUser
@using SKC.Entity.DBModels;
@using SKC.Entity.Enums;
@using SKC.Entity.Models;
@{
    ViewData["Title"] = "SilkChain - KYC";
    var user_audit = ViewBag.UserAudit as SkcUserAuthentication;
    var item_user = user_audit ?? new SkcUserAuthentication();
    var already_audit = new List<int> { (int)EnumUserAuthStatus.待审核, (int)EnumUserAuthStatus.通过 };
    var countrys = ViewBag.Lang as List<CountryModel>;
    string KycValidateCode = SKC.DAO.SystemParametersDAO.GetParamValue(SKC.Common.GlobalConfig.SysParams_KYCValidateCode, "0");//2018-05-16 增加kyc验证码开关

    var hide_info = Model.StatusInt == 1 || (user_audit != null && already_audit.Contains(user_audit.AuthStatusInt)) ? "true" : "false";

    //已上传图片
    var ready_upload_img = Model.StatusInt == 1 || (user_audit != null && already_audit.Contains(user_audit.AuthStatusInt)) ? true : false;
}
<style>
    h3, .h3, h4, .h4 {
        margin: 20px 0px 15px;
    }

    label.m-dropzone {
        margin-bottom: 0;
    }

    .mb3 {
        margin-bottom: 30px
    }

    .account-status {
        display: inline-block;
        vertical-align: top;
        padding: 0 16px 0 5px;
        margin-top: 5px;
        margin-right: 10px;
        height: 40px;
        border-radius: 20px;
        color: #fff;
        background: #77b71b;
        line-height: 0;
    }

        .account-status .fa {
            font-size: 36px;
            margin-right: 6px;
            vertical-align: middle;
        }

        .account-status span {
            display: inline-block;
            vertical-align: middle;
            line-height: 40px;
            font-size: 20px
        }

        .account-status.no {
            background: #666;
        }

    .form-ft-oop .btn {
        min-width: 100px;
    }

    .form-control[readonly], .form-control {
        border-color: #ccc;
    }

        .form-control[disabled] {
            border-color: #ccc;
        }

    select.form-control-lg {
        height: calc(3.42857rem + 2px) !important;
    }

    .form-control-lg, .input-group-lg > .form-control, .input-group-lg > .input-group-addon, .input-group-lg > .input-group-btn > .btn {
        padding: 0.75rem 1rem;
    }

    select.custom-select {
        padding: 0.375rem 1.75rem 0.375rem 0.75rem;
    }

    .carousel {
        cursor: default;
    }

        .carousel .carousel-item img {
            max-width: 100%;
        }

        .carousel .carousel-indicators {
            margin-bottom: 0;
        }

            .carousel .carousel-indicators li {
                width: 10px;
                height: 10px;
                background-color: rgba(0,0,0,0.5);
                border-radius: 50%;
                margin-left: 6px;
                margin-right: 6px;
            }

            .carousel .carousel-indicators .active {
                background-color: #2485c9;
            }

    .yet-uploaded {
        width: 100%;
        height: 100%;
        padding: 10px;
        background-color: #f1f3f6;
        border-radius: 8px;
    }

    .dp-eq-ht {
        height: 270px;
    }

    .mid-demo-arrow {
        text-align: center;
        display: inline-flex;
        -webkit-box-align: center;
        -ms-flex-align: center;
        align-items: center;
        justify-content: center;
    }

    @@media (max-width: 768px) {
        .row {
            margin-left: -5px;
            margin-right: -5px;
        }

            .row .col,
            .row [class*="col-"] {
                padding-left: 5px;
                padding-right: 5px;
            }

        label, input, .form-control {
            font-size: 1.2307rem;
        }

        .font-s14 {
            font-size: 1.0769rem;
        }

        .dp-eq-ht {
            height: calc(100%*0.63 + 80px);
        }

        .mid-demo-arrow.dp-eq-ht {
            height: 40px;
        }

        label.dp-eq-ht {
            height: 270px;
        }

        .hold-xs-ft12 {
            font-size: 12px;
            margin-bottom: 0.5rem;
        }

        select.form-control-lg,
        .btn.btn-outline-focus {
            height: 42px !important;
        }
        label.dp-eq-ht .upload_img {max-width:264px !important;}
    }
</style>
<div class="m-grid__item m-grid__item--fluid m-wrapper">
    <div class="m-content">
        <form action="/account/CheckAccountInfo" id="amlcftForm" class="" enctype="multipart/form-data" method="POST">
            <input type="hidden" name="_token" value="4byV87InJp0fKNWC3pEZhzg0CZSnMHLdImi3Lryp">
            <input type="hidden" id="isChangeFront" name="isChangeFront" value="true" />@*@(!string.IsNullOrEmpty(item_user.FrontSideUrlNvarchar) ? "false" : "true")*@
            <input type="hidden" id="isChangeBack" name="isChangeBack" value="true" />
            <input type="hidden" id="isChangeSelfie" name="isChangeSelfie" value="true" />
            <input type="hidden" name="Option" value="EditAccount" />
            <input type="hidden" id="hd_country" name="User.NationalityNvarchar" />
            <input type="hidden" id="uuid" name="uuid" value="@ViewBag.uuid" />
            <div class="m-portlet m-portlet--mobile m-portlet--skin-dark">
                <div class="m-portlet__head">
                    <div class="m-portlet__head-caption">
                        <div class="m-portlet__head-title"><h3 class="m-portlet__head-text"><span class="font-weight-bold">@Html.GetTansByLan("account_index_tab2", "AML/CFT")</span></h3></div>
                    </div>
                </div>
                <div class="m-portlet__body">

                    <div class="row">
                        <div class="col-lg-12">
                            <h4 class="sub-title" style="margin-top:0;">
                                <i class="la la-user"></i>@Html.GetTansByLan("account_index_tab2_bar1", "Account status")
                            </h4>
                        </div>
                        <div class="col-lg-12">
                            @if (Model.StatusInt == 1)//已认证
                            {
                                <div class="account-status">
                                    <i class="fa fa-check-circle" aria-hidden="true"></i><span>@Html.GetTansByLan("account_index_tab2_state1", "Verification Passed")   </span>
                                </div>
                            }
                            else//待认证或认证中
                            {
                                @if (user_audit == null)
                                {
                                    <div class="account-status no">
                                        <i class="fa fa-exclamation-circle" aria-hidden="true"></i><span>@Html.GetTansByLan("account_index_tab2_state2", "Unverified")</span>
                                    </div>
                                    <p class="font-s14" style="display: block;font-style: italic;margin-top:15px;">
                                        @Html.GetTansByLan("account_index_tab2_text1", "please complete the KYC certification in time, otherwise, you will not be able to purchase and withdraw deposit.")
                                    </p>
                                }
                                else
                                {
                                    @if (user_audit != null && user_audit.AuthStatusInt == (int)EnumUserAuthStatus.不通过)
                                    {
                                        <div class="account-status no">
                                            <i class="fa fa-exclamation-circle" aria-hidden="true"></i><span>@Html.GetTansByLan("account_index_tab2_state3", "Verification Failed") </span>
                                        </div>
                                        <p class="font-s14" style="display: block;font-style: italic;margin-top:15px;">
                                            @Html.GetTansByLan("account_index_no_check2", "Your KYC has not been approved, and here is the reason")
                                            <span>:@((user_audit.AuthMessageNvarchar ?? "").Contains("account-lock") ? Html.GetTansByLan(user_audit.AuthMessageNvarchar, "Verification Failed") : user_audit.AuthMessageNvarchar) </span>
                                            <span>,@Html.GetTansByLan("account_index_no_check3", "please resubmit KYC information.")</span>
                                        </p>
                                    }
                                    else
                                    {
                                        <div class="account-status no">
                                            <i class="fa fa-exclamation-circle" aria-hidden="true"></i><span>@Html.GetTansByLan("account_index_tab2_state4", "In Verification")</span>
                                        </div>
                                        <p class="font-s14" style="display: block;font-style: italic;margin-top:15px;">
                                            @Html.GetTansByLan("account_index_in_check1", "Your KYC is under review, please be patient.")
                                        </p>
                                    }
                                }

                            }

                        </div>
                    </div>
                    <hr style="margin:15px -1.78rem 10px;" />
                    <div class="row">
                        <div class="col-lg-12">
                            <h4 class="sub-title">
                                <i class="flaticon-lock-1"></i>@Html.GetTansByLan("account_index_tab2", "AML/CFT")
                            </h4>
                            <p class="font-s14" style="margin-bottom: 10px">
                                @Html.GetTansByLan("account_index_tab2_text2", "Anti-Money Laundering and Countering the Financing of Terrorism")
                            </p>
                            @if (Model.StatusInt != 1)
                            {
                                @*<p class="font-s14" style="margin-bottom: 30px">
                                        @Html.GetTansByLan("account_index_tab2_text3", "Your account hasn't validated with KYC yet.")
                                        <br>
                                        @Html.GetTansByLan("account_index_tab2_text4", "Please update your KYC information to allow trading.")
                                    </p>*@
                            }
                        </div>
                        <div class="col-lg-12">
                            <div class="form-group m-form__group row mb3">
                                <div class="col-6">
                                    <label for="fullName">@Html.GetTansByLan("account_index_tab2_tag1", "First Name") <span class="m--font-danger">*</span></label>
                                    <input class="form-control form-control-lg m-input" name="User.FirstNameNvarchar" id="firstName" type="text" value="@(item_user.FirstNameNvarchar)" required>
                                </div>
                                <div class="col-6">
                                    <label for="fullName">@Html.GetTansByLan("account_index_tab2_tag2", "Last Name") <span class="m--font-danger">*</span></label>
                                    <input class="form-control form-control-lg m-input" name="User.LastNameNvarchar" id="lastName" type="text" value="@(item_user.LastNameNvarchar)" required>
                                </div>
                            </div>
                            @*<div class="form-group m-form__group mb3">
                                    <label for="country_of_residence">@Html.GetTansByLan("account_index_tab2_tag3", "Phone number")<span class="m--font-danger">*</span></label>
                                    <p class="light-color font-s14"><i>** @Html.GetTansByLan("account_index_tab2_tag4", "Example"): +84  988666888</i></p>
                                    <div class="form-group m-form__group row">
                                            </select>
                                        </div>
                                        <div class="col-7 col-sm-8 col-lg-10">
                                            <input class="form-control form-control-lg m-input" name="User.PhoneNvarchar" id="phone" type="text" value="@(item_user.PhoneNvarchar)" required placeholder="" style="    display: inline-block;    padding-right: 5px;">
                                        </div>
                                    </div>
                                </div>*@
                            <div class="form-group m-form__group mb3">
                                <label for="Nationality">@Html.GetTansByLan("account_index_tab2_tag5", "Nationality") <span class="m--font-danger">*</span></label>
                                <div class="form-group m-form__group row">
                                    <div class="col-12">
                                        <select class="custom-select form-control form-control-lg" id="sel_nationality" name="User.NationalityCodeNvarchar" required>
                                            <option value="">@Html.GetTansByLan("account_index_opt_tag1", "Select Nationality")</option>
                                            @if (countrys != null && countrys.Count > 0)
                                            {
                                                foreach (var item in countrys)
                                                {
                                                    if (item_user.NationalityCodeNvarchar == item.Code)
                                                    {
                                                        <option value="@item.Code" selected="selected">@item.Name</option>
                                                    }
                                                    else
                                                    {
                                                        <option value="@item.Code">@item.Name</option>
                                                    }

                                                }
                                            }
                                        </select>
                                    </div>
                                </div>
                            </div>
                            <div class="form-group m-form__group mb3">
                                <label for="country_of_residence">@Html.GetTansByLan("account_index_tab2_tag6", "Identification Type") <span class="m--font-danger">*</span></label>
                                <div class="form-group m-form__group row">
                                    <div class="col-12">
                                        <select class="custom-select form-control form-control-lg" name="User.IdentificationTypeNvarchar" id="idType" required>
                                            <option value="FOREIGN IDENTITY CARD" selected="@(item_user.IdentificationTypeNvarchar=="FOREIGN IDENTITY CARD"||item_user.IdentificationTypeNvarchar==null?"selected":"")">@Html.GetTansByLan("account_index_tab2_sel_tag1", "IDENTITY CARD")</option>
                                            <option value="PASSPORT" selected="@(item_user.IdentificationTypeNvarchar=="PASSPORT"?"selected":"")">@Html.GetTansByLan("account_index_tab2_sel_tag2", "PASSPORT")</option>
                                            <option value="DRIVING LICENSE" selected="@(item_user.IdentificationTypeNvarchar=="DRIVING LICENSE"?"selected":"")">@Html.GetTansByLan("account_index_tab2_sel_tag3", "DRIVING LICENSE")</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                            <div class="form-group m-form__group mb-0">
                                <label for="country_of_residence"><span id="numberIdTitle">@Html.GetTansByLan("account_index_tab2_tag7", "Identification Number")  </span> <span class="m--font-danger">*</span></label>
                                <div class="form-group m-form__group row">
                                    <div class="col-12">
                                        @if (Model.StatusInt == 1 || (user_audit != null && already_audit.Contains(user_audit.AuthStatusInt)))
                                        {<input class="form-control form-control-lg m-input" name="User.IdentificationNumberNvarchar" id="identificationNumber" type="text" placeholder="******">
                                        }
                                        else
                                        {
                                            <input class="form-control form-control-lg m-input" name="User.IdentificationNumberNvarchar" id="identificationNumber" type="text" value="@item_user.IdentificationNumberNvarchar" required>
                                        }
                                    </div>
                                </div>
                            </div>

                        </div>
                    </div>

                </div>
            </div>

            <div class="m-portlet m-portlet--mobile m-portlet--skin-dark">
                <div class="m-portlet__body">

                    <div class="form-group m-form__group mb3">
                        <label for="id_number" style="margin-bottom: 20px"><span id="fontTitle">@Html.GetTansByLan("account_index_tab2_tag8", "Identity Card Front Side")  </span> <span class="m--font-danger">*</span></label>
                        <div class="form-group m-form__group row">
                            <div class="col-12">
                                <label for="photoFrontSide" onclick="javascript: $('#sp_photo_front_side').click();" class="btn btn-primary m-btn--pill @(ready_upload_img?"disabled":"")">@Html.GetTansByLan("account_index_tab2_tag9", "Choose file")</label>
                            </div>
                            <div class="col-12">
                                <p class="light-color font-s14" style="display: block;font-style: italic;">**@Html.GetTansByLan("account_index_tab2_text5", "Please make sure that the photo is complete and clearly visible.") </p>
                            </div>
                        </div>
                    </div>
                    <div class="form-group m-form__group row mb3">
                        <div class="col-md-5">
                            <div id="divPhotoFrontSide">
                                <label class="m-dropzone dropzone dz-clickable dp-eq-ht" style="width:100%;">
                                    @if (ready_upload_img)
                                    {
                                        <div class="yet-uploaded">
                                            <img class="default_img" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACQAAAAsCAYAAAANUxr1AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoV2luZG93cykiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6RkMzMjY5NjU1MjY2MTFFOEE1MTg5NzA4QzQ5M0QzRTEiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6RkMzMjY5NjY1MjY2MTFFOEE1MTg5NzA4QzQ5M0QzRTEiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDpGQzMyNjk2MzUyNjYxMUU4QTUxODk3MDhDNDkzRDNFMSIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDpGQzMyNjk2NDUyNjYxMUU4QTUxODk3MDhDNDkzRDNFMSIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/Pp9z5YYAAAG/SURBVHja7JjNKwRhHMef3XZWxsHbgROpOTgSuXiJUFM25eSfcFDKxSoK5z1wc3BRmgOR1RI3orzEUbZECQfhtLjwnfantm1m2mfN88xo51ef5pmd56nPzvN7XuYJGYbBEA1gBuigHoSYu/EOjsEsOHGqGAFNVLmOiYtK+rP9YBRsOAnNk8wVmABvLsu0gGUqK2ANjIAdOyGdynPgQMDbKc+7j4J1MAz28iuHQTWVM0x8XNK1jLqt10pIZgyACyqrYBt0ein0Qol9SvcVIAk6vBJiNGgGwVHOCNwFrV4ItREaiIM7+r0K7IPGiGShM4dnNWDaiy5zij4ZQoe0FDnRTXVr/faGWCAUCP01eOchnTZzPHEPUqKExsAQZ5ukSKE0OC+iDVeXZSw2UXYxLiOpv4JR9g+EolZJ/VFAwwTosnnW7saHQK7QZwENNdpg+WZiXARbAn0UXqGU4FxSg1Hmdg5p9NnCe/KRFiWUKHJxjZVMl8VKLqkDoUDITSHFL0JPVO7x0EOl66s5D22CSeIGXEuWMQ+r4r+7CVNogWWPaJvBqodv6RlMhWnxM09Cl8AD+JYs8ghWWPbg8/ZHgAEAFmtEminiBVoAAAAASUVORK5CYII=" style="margin-top:60px;margin-left:auto;margin-right:auto;display:block" />
                                            <span class="file_label" style="margin-top:20px;width:100%;display:block;color:#2485c9;">@Html.GetTansByLan("account_index_tab2_sub1", "Document submitted")</span>
                                        </div>
                                    }
                                    else
                                    {
                                        <span id="sp_photo_front_side"  onclick="UploadImg.ShowUpload('sp_photo_front_side','', 'https://i.silkchain.io', 20, 0, 5,'@Html.GetLang()')">
                                            <img class="upload_img" style="max-width: 300px;max-height: 226px;margin: auto auto;" onerror="resetImgUrl(this)" />
                                            <img class="default_img" src="/images/ba-common/ic_image_default.png" style="margin-top:60px;margin-left:auto;margin-right:auto;" />
                                            <span class="file_label" style="margin-top: 20px;width: 100%;font-weight: 600;display: block;">@Html.GetTansByLan("account_index_tab2_text20", "Click to upload")</span>
                                        </span>
                                    }
                                </label>
                            </div>
                        </div>
                        <div class="col-md-2 mid-demo-arrow dp-eq-ht">
                            @Html.GetTansByLan("account_index_tab2_tag4", "Example") <i class="la la-angle-right"></i>
                        </div>
                        <div class="col-md-5">
                            <div class="m-dropzone dropzone dz-clickable dp-eq-ht" style="width:100%;">
                                <div id="carouselFrontSide" class="carousel slide" data-ride="carousel">
                                    <ol class="carousel-indicators">
                                        <li data-target="#carouselFrontSide" data-slide-to="0" class="active"></li>
                                        <li data-target="#carouselFrontSide" data-slide-to="1"></li>
                                    </ol>
                                    <div class="carousel-inner">
                                        <div class="carousel-item active">
                                            <img src="/images/ba-common/id_front.png" />
                                        </div>
                                        <div class="carousel-item">
                                            <img src="/images/ba-common/id_front2.png" />
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <hr class="mb3" />
                    <div class="form-group m-form__group mb3">
                        <label for="id_number" style="margin-bottom: 20px"><span id="backTitle">@Html.GetTansByLan("account_index_tab2_text6", "Identity Card Back Side")   </span><span class="m--font-danger">*</span></label>
                        <div class="form-group m-form__group row">
                            <div class="col-12">
                                <label for="photoBackSide"  onclick="javascript: $('#sp_photo_back_side').click();" class="btn btn-primary m-btn--pill @(ready_upload_img?"disabled":"")">@Html.GetTansByLan("account_index_tab2_but1", "Choose file")</label>
                            </div>
                            <div class="col-12">
                                <p class="light-color font-s14" style="display: block;font-style: italic;">**@Html.GetTansByLan("account_index_tab2_text7", "Please make sure that the photo is complete and clearly visible.")  <span class="card_type2">@Html.GetTansByLan("account_index_tab2_text8", "ID card")</span>@Html.GetTansByLan("account_index_tab2_text9", "must be in the valid period.") </p>
                            </div>
                        </div>
                    </div>
                    <div class="form-group m-form__group row mb3">
                        <div class="col-md-5">
                            <div id="divPhotoBackSide">
                                <label class="m-dropzone dropzone dz-clickable dp-eq-ht" style="width:100%;">
                                    @if (ready_upload_img)
                                    {
                                        <div class="yet-uploaded">
                                            <img class="default_img" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACQAAAAsCAYAAAANUxr1AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoV2luZG93cykiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6RkMzMjY5NjU1MjY2MTFFOEE1MTg5NzA4QzQ5M0QzRTEiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6RkMzMjY5NjY1MjY2MTFFOEE1MTg5NzA4QzQ5M0QzRTEiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDpGQzMyNjk2MzUyNjYxMUU4QTUxODk3MDhDNDkzRDNFMSIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDpGQzMyNjk2NDUyNjYxMUU4QTUxODk3MDhDNDkzRDNFMSIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/Pp9z5YYAAAG/SURBVHja7JjNKwRhHMef3XZWxsHbgROpOTgSuXiJUFM25eSfcFDKxSoK5z1wc3BRmgOR1RI3orzEUbZECQfhtLjwnfantm1m2mfN88xo51ef5pmd56nPzvN7XuYJGYbBEA1gBuigHoSYu/EOjsEsOHGqGAFNVLmOiYtK+rP9YBRsOAnNk8wVmABvLsu0gGUqK2ANjIAdOyGdynPgQMDbKc+7j4J1MAz28iuHQTWVM0x8XNK1jLqt10pIZgyACyqrYBt0ein0Qol9SvcVIAk6vBJiNGgGwVHOCNwFrV4ItREaiIM7+r0K7IPGiGShM4dnNWDaiy5zij4ZQoe0FDnRTXVr/faGWCAUCP01eOchnTZzPHEPUqKExsAQZ5ukSKE0OC+iDVeXZSw2UXYxLiOpv4JR9g+EolZJ/VFAwwTosnnW7saHQK7QZwENNdpg+WZiXARbAn0UXqGU4FxSg1Hmdg5p9NnCe/KRFiWUKHJxjZVMl8VKLqkDoUDITSHFL0JPVO7x0EOl66s5D22CSeIGXEuWMQ+r4r+7CVNogWWPaJvBqodv6RlMhWnxM09Cl8AD+JYs8ghWWPbg8/ZHgAEAFmtEminiBVoAAAAASUVORK5CYII=" style="margin-top:60px;margin-left:auto;margin-right:auto;display:block" />
                                            <span class="file_label" style="margin-top: 20px;width: 100%;display:block;color:#2485c9;">@Html.GetTansByLan("account_index_tab2_sub1", "Document submitted")</span>
                                        </div>
                                    }
                                    else
                                    {
                                        <span id="sp_photo_back_side" onclick="UploadImg.ShowUpload('sp_photo_back_side','', 'https://i.silkchain.io', 20, 0, 5,'@Html.GetLang()')">
                                            <img class="upload_img" style="max-width: 300px;max-height: 226px;margin: auto auto;"  onerror="resetImgUrl(this)" />
                                            <img class="default_img" src="/images/ba-common/ic_image_default.png" style="margin-top:60px;margin-left:auto;margin-right:auto;" />
                                            <span class="file_label" style="margin-top: 20px;width: 100%;font-weight: 600;display: block;">@Html.GetTansByLan("account_index_tab2_text20", "Click to upload")</span>
                                        </span>
                                    }
                                </label>
                            </div>
                        </div>
                        <div class="col-md-2 mid-demo-arrow dp-eq-ht">
                            @Html.GetTansByLan("account_index_tab2_tag4", "Example") <i class="la la-angle-right"></i>
                        </div>
                        <div class="col-md-5">
                            <div class="m-dropzone dropzone dz-clickable dp-eq-ht" style="width:100%;">
                                <div id="carouselBackSide" class="carousel slide" data-ride="carousel">
                                    <ol class="carousel-indicators">
                                        <li data-target="#carouselBackSide" data-slide-to="0" class="active"></li>
                                        <li data-target="#carouselBackSide" data-slide-to="1"></li>
                                    </ol>
                                    <div class="carousel-inner">
                                        <div class="carousel-item active">
                                            <img src="/images/ba-common/id_back.png" />
                                        </div>
                                        <div class="carousel-item">
                                            <img src="/images/ba-common/id_back2.png" />
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <hr class="mb3" />
                    <div class="form-group m-form__group mb3">
                        <label for="id_number" style="margin-bottom: 20px" class="selfie_text">@Html.GetTansByLan("account_index_tab2_text10", "Selfie With Photo ID And Note.")  <span class="m--font-danger">*</span></label>
                        <div class="form-group m-form__group row">
                            <div class="col-12">
                                <label for="photoSelfie"  onclick="javascript: $('#sp_photo_selfie').click();" class="btn btn-primary m-btn--pill  @(ready_upload_img?"disabled":"")">@Html.GetTansByLan("account_index_tab2_tag9", "Choose file")</label>
                            </div>
                            <div class="col-12">
                                <p class="light-color font-s14" style="display: block;font-style: italic;">
                                    ** @Html.GetTansByLan("account_index_tab2_text11", "Please provide a photo of you holding your")  <span class="card_type">@Html.GetTansByLan("account_index_tab2_text12", "Identity Card")</span>@Html.GetTansByLan("account_index_tab2_text13", "In the same picture,")  <span class="m--font-danger">@Html.GetTansByLan("account_index_tab2_text14", "make a reference to SILK and today’s date displayed")</span>.@Html.GetTansByLan("account_index_tab2_text15", "Make sure your face is clearly visible and that all passport details are clearly readable.")
                                </p>
                            </div>
                            <div class="col-12 row" style="padding:0px">
                                <div class="col-6"><p class="light-color font-s14 hold-xs-ft12" style="display: block;font-style: italic;"><i class="la la-check" style="margin-left: 10px"></i>@Html.GetTansByLan("account_index_tab2_text16", "Face clearly visible")</p></div>
                                <div class="col-6"><p class="light-color font-s14 hold-xs-ft12" style="display: block;font-style: italic;"><i class="la la-check" style="margin-left: 10px"></i>@Html.GetTansByLan("account_index_tab2_text18", "Photo ID clearly visible")</p></div>
                            </div>
                        </div>
                    </div>
                    <div class="form-group m-form__group row mb-0">
                        <div class="col-md-5">
                            <div id="fileIdPhotoUpload">
                                <label class="m-dropzone dropzone dz-clickable dp-eq-ht" style="width:100%;">
                                    @if (ready_upload_img)
                                    {
                                        <div class="yet-uploaded">
                                            <img class="default_img" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACQAAAAsCAYAAAANUxr1AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoV2luZG93cykiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6RkMzMjY5NjU1MjY2MTFFOEE1MTg5NzA4QzQ5M0QzRTEiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6RkMzMjY5NjY1MjY2MTFFOEE1MTg5NzA4QzQ5M0QzRTEiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDpGQzMyNjk2MzUyNjYxMUU4QTUxODk3MDhDNDkzRDNFMSIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDpGQzMyNjk2NDUyNjYxMUU4QTUxODk3MDhDNDkzRDNFMSIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/Pp9z5YYAAAG/SURBVHja7JjNKwRhHMef3XZWxsHbgROpOTgSuXiJUFM25eSfcFDKxSoK5z1wc3BRmgOR1RI3orzEUbZECQfhtLjwnfantm1m2mfN88xo51ef5pmd56nPzvN7XuYJGYbBEA1gBuigHoSYu/EOjsEsOHGqGAFNVLmOiYtK+rP9YBRsOAnNk8wVmABvLsu0gGUqK2ANjIAdOyGdynPgQMDbKc+7j4J1MAz28iuHQTWVM0x8XNK1jLqt10pIZgyACyqrYBt0ein0Qol9SvcVIAk6vBJiNGgGwVHOCNwFrV4ItREaiIM7+r0K7IPGiGShM4dnNWDaiy5zij4ZQoe0FDnRTXVr/faGWCAUCP01eOchnTZzPHEPUqKExsAQZ5ukSKE0OC+iDVeXZSw2UXYxLiOpv4JR9g+EolZJ/VFAwwTosnnW7saHQK7QZwENNdpg+WZiXARbAn0UXqGU4FxSg1Hmdg5p9NnCe/KRFiWUKHJxjZVMl8VKLqkDoUDITSHFL0JPVO7x0EOl66s5D22CSeIGXEuWMQ+r4r+7CVNogWWPaJvBqodv6RlMhWnxM09Cl8AD+JYs8ghWWPbg8/ZHgAEAFmtEminiBVoAAAAASUVORK5CYII=" style="margin-top:60px;margin-left:auto;margin-right:auto;display:block" />
                                            <span class="file_label" style="margin-top: 20px;width: 100%;display:block;color:#2485c9;">@Html.GetTansByLan("account_index_tab2_sub1", "Document submitted")</span>
                                        </div>
                                    }
                                    else
                                    {
                                        <span id="sp_photo_selfie" onclick="UploadImg.ShowUpload('sp_photo_selfie','', 'https://i.silkchain.io', 20, 0, 5,'@Html.GetLang()')">
                                            <img class="upload_img" style="max-width: 300px;max-height: 226px;margin: auto auto;"  onerror="resetImgUrl(this)" />
                                            <img class="default_img" src="/images/ba-common/ic_image_default.png" style="margin-top:60px;margin-left:auto;margin-right:auto;" />
                                            <span class="file_label" style="margin-top: 20px;width: 100%;font-weight: 600;display: block;">@Html.GetTansByLan("account_index_tab2_text20", "Click to upload")</span>
                                        </span>
                                    }
                                    </label>
                            </div>
                        </div>
                        <div class="col-md-2 mid-demo-arrow dp-eq-ht">
                            @Html.GetTansByLan("account_index_tab2_tag4", "Example") <i class="la la-angle-right"></i>
                        </div>
                        <div class="col-md-5">
                            <div class="m-dropzone dropzone dz-clickable dp-eq-ht" style="width:100%;">
                                <div id="carouselSelfie" class="carousel slide" data-ride="carousel">
                                    <ol class="carousel-indicators">
                                        <li data-target="#carouselSelfie" data-slide-to="0" class="active"></li>
                                        <li data-target="#carouselSelfie" data-slide-to="1"></li>
                                    </ol>
                                    <div class="carousel-inner">
                                        <div class="carousel-item active">
                                            <img src="/images/ba-common/pp_selfie_default.png" />
                                        </div>
                                        <div class="carousel-item">
                                            <img src="/images/ba-common/pp_selfie_default.png" />
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>
            </div>



            @if (Model.StatusInt == 0)
            {
                var need_audit = new List<int> {
                (int)EnumUserAuthStatus.不通过
                 };
                if (user_audit == null || (user_audit != null && need_audit.Contains(user_audit.AuthStatusInt)))//未认证,未通过
                {
                    if (KycValidateCode == "1")
                    {
                        <div class="m-portlet m-portlet--mobile m-portlet--skin-dark">
                            <div class="m-portlet__body">
                                @*<div class="form-group m-form__group row">
                                        <div class="col-5 col-sm-4 col-lg-2" style="padding-right:5px;">
                                            <select class="custom-select form-control form-control-lg" id="sel_area_code">
                                                @if (countrys != null && countrys.Count > 0)
                                                {
                                                    foreach (var item in countrys)
                                                    {
                                                        <option value="@item.AreaCode"> @item.Name +@(item.AreaCode)</option>
                                                    }
                                                }
                                            </select>
                                        </div>
                                        <div class="col-7 col-sm-8 col-lg-10" style="padding-left:5px;">
                                            <input class="form-control form-control-lg m-input" id="txt_phone_no" data-opt="CheckPhone" type="text" placeholder="@Html.GetTansByLan("account-register-6", "Phone Number")" style="display:inline-block;padding-right: 5px;">
                                        </div>
                                    </div>*@
                                <div class="form-group m-form__group row mb-0">
                                    <div class="col-9" style="padding-right:5px;">
                                        <input class="form-control form-control-lg m-input" type="text" id="txt_valid" name="ValidCode" placeholder="@Html.GetTansByLan("account-register-valid-7", "Click to get verification code")">
                                    </div>
                                    <div class="col-3" style="padding-left:5px;">
                                        <button class="btn btn-outline-focus" type="button" id="but_phone_code" style="padding-left:0;padding-right:0;text-align:center;width:100%;height:3.571428rem;">@Html.GetTansByLan("account-register-8", "Send")</button>
                                    </div>
                                </div>
                            </div>
                        </div>}
                    <div class="m-portlet m-portlet--mobile m-portlet--skin-dark mb-0">
                        <div class="m-portlet__body form-ft-oop">
                            <button type="reset" class="btn btn-default m-btn--pill" onclick="resetAMLForm()">
                                @Html.GetTansByLan("account_index_tab2_but11", "Reset")
                            </button>
                            <span>&nbsp; &nbsp;</span>
                            <button class="btn btn-primary m-btn--pill" type="submit" id="aml_submit_button">
                                @Html.GetTansByLan("account_index_tab2_but12", "Submit")
                            </button>
                        </div>
                    </div>
                }
            }
        </form>
    </div>
</div>
<div class="modal fade" id="modal_success" tabindex="-1" role="dialog" style="display: none;z-index: 1042 ;" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="m-0 m-alert m-alert--icon m-alert--outline alert alert-primary alert-dismissible fade show" role="alert" style="border-color: #559CD3 !important;">
                <div class="m-alert__icon">
                    <i class="la la-check" style="color: #559CD3 !important;"></i>
                </div>
                <div class="m-alert__text dark-color font-size-16" style="padding-right: 0;padding-left: 10px;">

                </div>
                <div class="m-alert__close">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"></button>
                </div>
            </div>
        </div>
    </div>
</div>
<div class="modal fade" id="modal_errors" tabindex="-1" role="dialog" style="display: none;z-index: 1042;" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="m-alert m-alert--icon m-alert--icon-solid m-alert--outline alert alert-danger alert-dismissible fade show m-0" role="alert">
                <div class="m-alert__icon p-0" style="padding: 15px !important;">
                    <i class="flaticon-exclamation-2"></i>
                </div>
                <div class="m-alert__text dark-color font-size-16" style="padding-right: 0;padding-left: 10px;">
                </div>
                <div class="m-alert__close">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"></button>
                </div>
            </div>
        </div>
    </div>
</div>

@section script{
    <script src="~/js/sweetalert.min.js"></script>
    <script src="~/js/loading.js"></script>
    <script src="https://imgserver.silkchain.io/js/UploadImg.js?t=1532077334076"></script>
    <script type="text/javascript">
    var status = "EMPTY";
    var isAddNew = 'no';
    var validatedPhone = true;
    function resetAMLForm() {
        $("#amlcftForm")[0].reset();
        if (isAddNew != '') {
            hiddenImg('#fileSelfiePhotoUpload', '#fileSelfiePhoto');
            hiddenImg('#fileIdPhotoUpload', '#fileIdPhoto');
            $("#isIdPhotoNew").val(false);
            $("#isSelfiePhotoNew").val(false);
        }
    }
    $(function () {
        @*$("#sub_phone").val('@Html.Raw(item_user.PhoneSysbomNvarchar)');
        $("#sel_nationality").val('@item_user.NationalityNvarchar');
        $("#idType").val('@item_user.IdentificationTypeNvarchar');*@

        if (@hide_info==true) {
            $("#sel_nationality").prepend("<option value='' selected='selected'>******</option>");
            $("#idType").prepend("<option value='' selected='selected'>******</option>");
        }

        $("#sel_nationality").change(function () {
            $("#hd_country").val($(this).val() != ""?$(this).find('option:selected').text():"");
        });



        $('input[type=file]').on('change', function (e) {
            if ($(this)[0].files[0].size > 5242880) {
                $('#modal_errors .m-alert__text').html("@Html.Raw(Html.GetTansByLan("account-kyc-error-imagesize", "image great than 5mb"))");
                $('#modal_errors').modal();
                return false;
            }
            $(this).parent().find(".upload_img").attr('src', '');
            $(this).parent().find(".upload_img").attr('src', window.URL.createObjectURL($(this)[0].files[0]));
            $(this).parent().find(".upload_img").css("display", "block");
            $(this).parent().find(".default_img").css("display", "none");
            $(this).parent().find(".file_label").css("display", "none");

            if ($(this)[0].name == "photoFrontSide") {
                $("#isChangeFront").val('true');
            } else if ($(this)[0].name == "photoBackSide") {
                $("#isChangeBack").val('true');
            } else if ($(this)[0].name == "photoSelfie") {
                $("#isChangeSelfie").val('true');
            }
        });
        $('#amlcftForm').on('submit', function (e) {
            e.preventDefault();
            $('#amlcftForm').find('input[type=submit]').prop('disabled', true);
            $('#amlcftForm').find('button[type=submit]').prop('disabled', true);
            if (status == "ACCEPTED" || status == "CLEARED") {
                $('#modal_success .m-alert__text').html("Infomation is accepted");
                $('#modal_success').modal();
                $('#aml_submit_button').prop('disabled', false);
            } else if (status == "PENDING") {
                $('#modal_success .m-alert__text').html("Infomation is checking");
                $('#modal_success').modal();
                $('#aml_submit_button').prop('disabled', false);
            } else if ("EMPTY" == status || "REJECTED" == status) {

                var photoFrontSide = $('input[name="photoFrontSide"]')[0];
                var photoBackSide = $('input[name="photoBackSide"]')[0];
                var photoSelfie = $('input[name="photoSelfie"]')[0];
                var isValid = true;
                var msg = "";

                if (valid.params.font_side == "") { 
                    msg += '@Html.GetTansByLan("account-kyc-img-tip001", "Identity Card Front Side is Empty")<br>';
                    isValid = false;
                }

                if (valid.params.back_side == "") { 
                    msg += '@Html.GetTansByLan("account-kyc-img-tip002", "Identity Card Back Side is Empty")<br>';
                    isValid = false;
                }

                if (valid.params.selfie == "") { 
                    msg += '@Html.GetTansByLan("account-kyc-img-tip003", "Selfie With Photo ID And Note is Empty")<br>';
                    isValid = false;
                }
                
                if (isValid) {
                    var resend = "resend";
                    if (validatedPhone) {
                        $(".m-loader").show();
                        $('#amlcftForm .form-control-feedback').empty();
                        var data = new FormData($('#amlcftForm')[0]);
                        data.append("User.FrontSideUrlNvarchar", valid.params.font_side);
                        data.append("User.BackSideUrlNvarchar", valid.params.back_side);
                        data.append("User.IdandNoteUrlNvarchar", valid.params.selfie);

                        $.ajax({
                            type: "POST",
                            url: $(this).attr('action'),
                            data: data,
                            enctype: 'multipart/form-data',
                            processData: false,
                            contentType: false,
                            cache: false,
                            beforeSend: function () {
                                $.showLoading('@Html.Raw(Html.GetTansByLan("account-kyc-tip001", "Waiting"))');
                            },
                            complete: function () {
                                $.hideLoading();
                            }
                        }).done(function (data) {
                            $('#amlcftForm').find('input[type=submit]').prop('disabled', false);
                            $('#amlcftForm').find('button[type=submit]').prop('disabled', false);
                            $(".m-loader").hide();
                            if (!data.result) {
                                var ht = ""
                                //for (var i in data.error) {
                                //    ht += data.error[i] + "<br />";
                                //}
                                $('#modal_errors .m-alert__text').html(data.message);
                                $('#modal_errors').modal();
                            } else {
                                status = "PENDING";
                                var success_text = "@Html.Raw(Html.GetTansByLan("account_kyc_sumbit_success", "Your KYC information will be verify in about a day.<br>When after verification, we will send a email for you.<br>This certification is not open to clients from public-offering prohibition countries (include but not limited to the USA, China, Iran, Singapore......)"))";
                                $('#modal_success .m-alert__text').html(success_text);
                                $('#modal_success').modal();
                                $('#modal_success').one('hide.bs.modal', function(){
                                    location.reload();
                                });
                            }
                        }).fail(function (xhr, status, error) {
                            $(".m-loader").hide();
                            if (xhr.status == 400) {
                                res = $.parseJSON(xhr.responseText);
                                var html = "";
                                for (var i in res) {
                                    html += res[i] + " </br>";
                                }
                                $('#modal_errors .m-alert__text').html(html);
                            } else {
                                $('#modal_errors .m-alert__text').text('Error! Please reload & try again.');
                            }
                            $('#modal_errors').modal();
                        });
                        return false;

                    }

                } else {
                    $('#modal_errors .m-alert__text').html(msg);
                    $('#modal_errors').modal();
                    $('#amlcftForm').find('input[type=submit]').prop('disabled', false);
                    $('#amlcftForm').find('button[type=submit]').prop('disabled', false);
                }
            }

        });

        });

        var valid = {
            params: {font_side:'',back_side:'',selfie:''},
            inItControl: function () {
                $("#but_phone_code").click(function () {
                    valid.request_data('/Account/CheckAccountInfo', { Option: 'KYCPhoneCode' }, { value:'KYCPhoneCode'});
                });
            },
            show_wait: function (obj) {
                var num = 120;
                var unit = '@Html.Raw(Html.GetTansByLan("account-findpwd-unit-01", " Seconds"))';
                $(obj).attr("disabled", true);
                var wait = setInterval(function () {
                    num--;
                    $(obj).html(num + unit);
                    if (num == 0) { $(obj).attr("disabled", false).html("Send"); clearInterval(wait); }
                }, 1000);
            },
            request_data: function (url, params, opt) {
                $.ajax({
                    type: 'post',
                    url: url,
                    data: params,
                    beforeSend: function () {
                        $("#but_phone_code").attr("disabled", true);
                        $("#aml_submit_button").attr("disabled", true);
                        $.showLoading('@Html.Raw(Html.GetTansByLan("account-kyc-tip001", "Waiting"))');
                    },
                    complete: function () {
                        $("#but_phone_code").attr("disabled", false);
                        $("#aml_submit_button").attr("disabled", false);
                        $.hideLoading();
                    },
                    success: function (data) {
                        switch (opt.value) {
                            case "KYCPhoneCode":
                                var obj = $("#but_phone_code");
                                if (data.result) {
                                    valid.show_wait(obj);
                                } else {
                                    obj.attr("disabled", false);
                                    swal(data.message);
                                }
                                break;
                            default:
                                break;
                        }
                    }, error: function () {
                        $('#modal_errors .m-alert__text').text('Error! Please reload & try again.');
                    }
                });
            }
        };

        $(function () {
            valid.inItControl();
            UploadImg.Init();    //页面加载时初始化上传图片
        });
    </script>
    <script type="text/javascript">
        function resetImgUrl(obj) {
            obj.src = obj.src.replace("https://i.silkchain.io", "https://imgserver.silkchain.io");
        }

        window.onmessage = function (e) {
            e = e || event;
            var result = e.data;
            var data = JSON.parse(result)
            var array = data.array;
            var sign = data.Sign;
            $("#" + sign).find(".upload_img").attr("src", array[0]).siblings(".default_img").hide();
            if (sign == "sp_photo_selfie") {
                valid.params.selfie = array[0];
            } else if (sign == "sp_photo_front_side") {
                valid.params.font_side = array[0];
            } else if (sign = "sp_photo_back_side") {
                valid.params.back_side = array[0];
            }
            

            UploadImg.HideUpload();   //关闭上传图片页面
        }
    </script>
}

